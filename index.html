<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spotify Clone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>

    <style>
      /* Custom scrollbar hiding */
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      
      /* Smooth transitions */
      .transition-all {
        transition: all 0.3s ease;
      }
      
      /* Play button animation */
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
      }
      .playing {
        animation: pulse 2s infinite;
      }
      
      /* Custom range slider */
      input[type="range"] {
        height: 4px;
        border-radius: 2px;
      }
      
      /* Hover effects */
      .hover-lift:hover {
        transform: translateY(-2px);
      }
    </style>
  </head>

  <body class="bg-black text-white font-sans">
    <!-- Layout Container -->
    <div class="flex h-screen">
      <!-- Sidebar -->
      <aside class="w-74 bg-black flex flex-col p-5 border-r border-zinc-800 overflow-y-auto scrollbar-hide">
        <h1 class="text-green-500 font-bold text-2xl mb-8">Spotify</h1>

        <!-- Navigation Menu -->
        <nav class="mb-6">
          <ul class="space-y-4">
            <li>
              <a href="#" class="flex items-center space-x-3 text-gray-300 hover:text-white transition-all">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                <span class="font-semibold">Home</span>
              </a>
            </li>
            <li>
              <a href="#" class="flex items-center space-x-3 text-gray-300 hover:text-white transition-all">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                </svg>
                <span class="font-semibold">Search</span>
              </a>
            </li>
            <li>
              <a href="#" class="flex items-center space-x-3 text-gray-300 hover:text-white transition-all">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12.5v-9l6 4.5-6 4.5z"/>
                </svg>
                <span class="font-semibold">Your Library</span>
              </a>
            </li>
          </ul>
        </nav>

        <!-- Create Playlist Section -->
        <div class="mt-2 space-y-4">
          <div class="bg-zinc-900 p-4 rounded-lg hover:bg-zinc-800 transition-all hover-lift">
            <p class="font-semibold mb-2">Create your first playlist</p>
            <p class="text-sm text-gray-400 mb-3">It's easy, we'll help you</p>
            <button class="bg-white text-black px-3 py-1 rounded-full font-bold text-sm hover:bg-gray-200 transition-all">
              Create playlist
            </button>
          </div>

          <div class="bg-zinc-900 p-4 rounded-lg hover:bg-zinc-800 transition-all hover-lift">
            <p class="font-semibold mb-2">Let's find some podcasts to follow</p>
            <p class="text-sm text-gray-400 mb-3">
              We'll keep you updated on new episodes
            </p>
            <button class="bg-white text-black px-3 py-1 rounded-full font-bold text-sm hover:bg-gray-200 transition-all">
              Browse podcasts
            </button>
          </div>
        </div>

        <!-- File Upload -->
        <div class="my-5 mx-auto">
          <label class="cursor-pointer bg-green-500 text-black px-4 py-2 rounded-lg text-sm font-bold hover:bg-green-400 transition-all flex items-center space-x-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            <span>Choose Music Folder</span>
            <input type="file" id="fileInput" webkitdirectory directory multiple hidden />
          </label>
        </div>

        <!-- Recently Played -->
        <div class="mt-4 flex-1">
          <h3 class="text-gray-400 text-sm font-semibold mb-3">RECENTLY PLAYED</h3>
          <div id="recentlyPlayed" class="space-y-2">
            <!-- Recently played songs will appear here -->
          </div>
        </div>

        <!-- Footer -->
        <div class="text-xs text-gray-400 mt-4">
          <div class="space-y-1 mb-3">
            <a href="#" class="hover:text-white transition-all block">Legal</a>
            <a href="#" class="hover:text-white transition-all block">Privacy</a>
            <a href="#" class="hover:text-white transition-all block">Cookies</a>
          </div>
          <button class="px-2 py-1 border border-gray-400 rounded-full text-sm hover:bg-zinc-800 transition-all">
            English
          </button>
        </div>
      </aside>

      <!-- Main Section -->
      <div class="flex-1 flex flex-col">
        <!-- Header with Search Bar -->
        <header class="p-4 bg-black flex items-center justify-between border-b border-zinc-800 sticky top-0 z-10">
          <!-- Navigation Controls -->
          <div class="flex items-center space-x-3">
            <button class="w-8 h-8 bg-zinc-900 rounded-full flex items-center justify-center hover:bg-zinc-800 transition-all">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
              </svg>
            </button>
            <button class="w-8 h-8 bg-zinc-900 rounded-full flex items-center justify-center hover:bg-zinc-800 transition-all">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
              </svg>
            </button>
          </div>

          <div class="flex items-center space-x-2 w-full max-w-lg bg-zinc-900 px-3 py-2 rounded-full ml-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z" />
            </svg>
            <input id="search" type="text" placeholder="What do you want to play?" class="bg-transparent outline-none text-sm w-full" />
          </div>

          <div class="space-x-3">
            <button class="font-semibold text-gray-300 hover:text-white transition-all">Sign up</button>
            <button class="bg-white text-black px-4 py-2 rounded-full font-bold hover:bg-gray-200 transition-all">Log in</button>
          </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto p-6 scrollbar-hide">
          <!-- Welcome Section -->
          <section class="mb-8">
            <h1 class="text-3xl font-bold mb-2">Good evening</h1>
            <p class="text-gray-400">Ready to listen to some great music?</p>
          </section>

          <!-- Quick Access -->
          <section class="mb-8">
            <h2 class="text-2xl font-bold mb-4">Quick Access</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
              <div class="bg-zinc-900 rounded-lg p-4 flex items-center space-x-4 hover:bg-zinc-800 transition-all cursor-pointer hover-lift">
                <div class="w-12 h-12 bg-green-500 rounded flex items-center justify-center">
                  <svg class="w-6 h-6 text-black" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                  </svg>
                </div>
                <span class="font-semibold">Liked Songs</span>
              </div>
              <div class="bg-zinc-900 rounded-lg p-4 flex items-center space-x-4 hover:bg-zinc-800 transition-all cursor-pointer hover-lift">
                <div class="w-12 h-12 bg-purple-500 rounded flex items-center justify-center">
                  <svg class="w-6 h-6 text-black" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                  </svg>
                </div>
                <span class="font-semibold">Recently Played</span>
              </div>
            </div>
          </section>

          <!-- Trending Songs -->
          <section class="mb-8">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-2xl font-bold">Trending Songs</h2>
              <button class="text-gray-400 hover:text-white text-sm font-semibold transition-all">
                Show all
              </button>
            </div>
            <div id="songsGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
              <!-- Songs will be appended dynamically here -->
            </div>
          </section>

          <!-- Made For You -->
          <section class="mb-8">
            <h2 class="text-2xl font-bold mb-4">Made For You</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
              <div class="bg-zinc-900 p-4 rounded-lg hover:bg-zinc-800 transition-all cursor-pointer group hover-lift">
                <div class="relative mb-4">
                  <img src="image/1.jpg" alt="Playlist" class="w-full aspect-square object-cover rounded">
                  <button class="absolute bottom-2 right-2 w-10 h-10 bg-green-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all hover:scale-105">
                    <svg class="w-5 h-5 text-black" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </button>
                </div>
                <h3 class="font-semibold truncate">Daily Mix 1</h3>
                <p class="text-sm text-gray-400 truncate">Based on your recent listening</p>
              </div>
              <div class="bg-zinc-900 p-4 rounded-lg hover:bg-zinc-800 transition-all cursor-pointer group hover-lift">
                <div class="relative mb-4">
                  <img src="image/2.jpg" alt="Playlist" class="w-full aspect-square object-cover rounded">
                  <button class="absolute bottom-2 right-2 w-10 h-10 bg-green-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all hover:scale-105">
                    <svg class="w-5 h-5 text-black" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </button>
                </div>
                <h3 class="font-semibold truncate">Discover Weekly</h3>
                <p class="text-sm text-gray-400 truncate">Your weekly mixtape of fresh music</p>
              </div>
            </div>
          </section>

          <!-- Popular Artist -->
          <section>
            <h2 class="text-2xl font-bold mb-4">Popular Artists</h2>
            <div class="flex space-x-6 overflow-x-auto pb-4 scrollbar-hide">
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/ar_rhmaan.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="A.R. Rahman">
                </div>
                <p class="text-sm font-semibold">A.R. Rahman</p>
                <p class="text-xs text-gray-400">Composer • Singer</p>
              </div>
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/arijit-singh-1200.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="Arijit Singh">
                </div>
                <p class="text-sm font-semibold">Arijit Singh</p>
                <p class="text-xs text-gray-400">Playback Singer</p>
              </div>
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/atif-aslam.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="Atif Aslam">
                </div>
                <p class="text-sm font-semibold">Atif Aslam</p>
                <p class="text-xs text-gray-400">Singer • Actor</p>
              </div>
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/jubin-nautiyals.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="Jubin Nautiyal">
                </div>
                <p class="text-sm font-semibold">Jubin Nautiyal</p>
                <p class="text-xs text-gray-400">Playback Singer</p>
              </div>
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/pritam.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="Pritam">
                </div>
                <p class="text-sm font-semibold">Pritam</p>
                <p class="text-xs text-gray-400">Music Composer</p>
              </div>
              <div class="w-38 shrink-0 text-center group">
                <div class="relative">
                  <img src="image/shreya.jpg" class="w-28 h-28 mx-auto rounded-full object-cover mb-2 group-hover:scale-105 transition-all" alt="Shreya Ghoshal">
                </div>
                <p class="text-sm font-semibold">Shreya Ghoshal</p>
                <p class="text-xs text-gray-400">Playback Singer</p>
              </div>
            </div>
          </section>
        </main>

        <!-- Player Bar -->
        <footer class="bg-zinc-900 p-3 flex items-center justify-between border-t border-zinc-800 sticky bottom-0 z-10">
          <!-- Current Song Info -->
          <div class="flex items-center space-x-3 w-1/4">
            <img src="" id="currentCover" alt="cover" class="w-12 h-12 object-cover rounded">
            <div class="min-w-0">
              <p id="currentTitle" class="text-sm font-bold truncate">No song selected</p>
              <p id="currentArtist" class="text-xs text-gray-400 truncate">---</p>
            </div>
            <button id="likeBtn" class="text-gray-400 hover:text-white transition-all">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
              </svg>
            </button>
          </div>
          
          <!-- Player Controls -->
          <div class="flex flex-col items-center w-2/4">
            <div class="flex items-center space-x-4 mb-2">
              <button id="shuffleBtn" class="text-gray-400 hover:text-white transition-all">🔀</button>
              <button id="prevBtn" class="text-gray-400 hover:text-white transition-all">⏮</button>
              <button id="playBtn" class="w-8 h-8 bg-white text-black rounded-full flex items-center justify-center hover:scale-105 transition-all">
                ▶
              </button>
              <button id="nextBtn" class="text-gray-400 hover:text-white transition-all">⏭</button>
              <button id="repeatBtn" class="text-gray-400 hover:text-white transition-all">🔁</button>
            </div>
            <div class="flex items-center space-x-2 w-full">
              <span id="currentTime" class="text-xs text-gray-400">0:00</span>
              <input id="progress" value="0" class="w-full accent-green-500" type="range" />
              <span id="duration" class="text-xs text-gray-400">0:00</span>
            </div>
          </div>

          <!-- Volume Control -->
          <div class="flex items-center space-x-2 w-1/4 justify-end">
            <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
              <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
            <input type="range" id="volume" min="0" max="1" step="0.01" value="1" class="w-32 accent-green-500">
          </div>
        </footer>
      </div>
    </div>

    <audio id="audio"></audio>

    <script>
      // DOM Elements
      const fileInput = document.getElementById("fileInput");
      const songsGrid = document.getElementById("songsGrid");
      const audio = document.getElementById("audio");
      const playBtn = document.getElementById("playBtn");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const progress = document.getElementById("progress");
      const volume = document.getElementById("volume");
      const currentCover = document.getElementById("currentCover");
      const currentTitle = document.getElementById("currentTitle");
      const currentArtist = document.getElementById("currentArtist");
      const search = document.getElementById("search");
      const currentTime = document.getElementById("currentTime");
      const duration = document.getElementById("duration");
      const likeBtn = document.getElementById("likeBtn");
      const shuffleBtn = document.getElementById("shuffleBtn");
      const repeatBtn = document.getElementById("repeatBtn");
      const recentlyPlayed = document.getElementById("recentlyPlayed");

      // Global Variables
      let songs = [];
      let currentIndex = 0;
      let isShuffled = false;
      let isRepeated = false;
      let likedSongs = new Set();
      let recentlyPlayedSongs = [];

      // Format time from seconds to MM:SS
      function formatTime(seconds) {
        if (isNaN(seconds)) return "0:00";
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
      }

      // Extract artist name from filename
      function extractArtistName(filename) {
        // Remove file extension
        const nameWithoutExt = filename.replace(/\.[^/.]+$/, "");
        
        // Common patterns for artist names in filenames
        const patterns = [
          /^(.+?)\s*-\s*.+$/, // "Artist - Song" format
          /^(.+?)\s+feat\.?.+$/i, // "Artist feat. Other" format
          /^(.+?)\s+vs\.?.+$/i, // "Artist vs. Other" format
          /^(.+?)\s+&.+$/i, // "Artist & Other" format
          /^(.+?)\s+with.+$/i, // "Artist with Other" format
        ];

        for (const pattern of patterns) {
          const match = nameWithoutExt.match(pattern);
          if (match && match[1]) {
            return formatArtistName(match[1].trim());
          }
        }

        // If no pattern matches, return the original filename as artist
        return formatArtistName(nameWithoutExt);
      }

      // Format artist name to proper case
      function formatArtistName(name) {
        return name
          .split(/[\s_-]+/)
          .map(word => {
            // Handle common abbreviations and special cases
            if (word.toLowerCase() === 'feat' || word.toLowerCase() === 'ft' || 
                word.toLowerCase() === 'vs' || word.toLowerCase() === 'with') {
              return word.toLowerCase();
            }
            return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
          })
          .join(' ')
          .replace(/\s+/g, ' ')
          .trim();
      }

      // Load song into player
      function loadSong(index) {
        const song = songs[index];
        if (!song) return;

        audio.src = URL.createObjectURL(song.file);
        currentTitle.textContent = song.title;
        currentArtist.textContent = song.artist;

        const coverSrc = song.cover && song.cover.trim() !== "" 
          ? song.cover 
          : fallbackImages[index % fallbackImages.length];
        
        currentCover.src = coverSrc;

        // Update like button state
        likeBtn.style.color = likedSongs.has(song.title) ? '#1DB954' : '#9CA3AF';
        
        // Add to recently played
        addToRecentlyPlayed(song);
        
        // Update duration display when metadata is loaded
        audio.addEventListener('loadedmetadata', function() {
          duration.textContent = formatTime(audio.duration);
        }, { once: true });

        audio.play();
        playBtn.innerHTML = "⏸";
        playBtn.classList.add('playing');
      }

      // Add song to recently played
      function addToRecentlyPlayed(song) {
        // Remove if already exists
        recentlyPlayedSongs = recentlyPlayedSongs.filter(s => s.title !== song.title);
        
        // Add to beginning
        recentlyPlayedSongs.unshift(song);
        
        // Keep only last 5
        if (recentlyPlayedSongs.length > 5) {
          recentlyPlayedSongs = recentlyPlayedSongs.slice(0, 5);
        }
        
        updateRecentlyPlayedUI();
      }

      // Update recently played UI
      function updateRecentlyPlayedUI() {
        recentlyPlayed.innerHTML = '';
        recentlyPlayedSongs.forEach(song => {
          const item = document.createElement('div');
          item.className = 'flex items-center space-x-3 p-2 rounded hover:bg-zinc-800 cursor-pointer transition-all';
          item.innerHTML = `
            <img src="${song.cover || fallbackImages[0]}" class="w-8 h-8 rounded object-cover" alt="${song.title}">
            <div class="min-w-0 flex-1">
              <p class="text-sm font-medium truncate">${song.title}</p>
              <p class="text-xs text-gray-400 truncate">${song.artist}</p>
            </div>
          `;
          item.addEventListener('click', () => {
            const index = songs.findIndex(s => s.title === song.title);
            if (index !== -1) {
              currentIndex = index;
              loadSong(currentIndex);
            }
          });
          recentlyPlayed.appendChild(item);
        });
      }

      // Play / Pause toggle
      playBtn.addEventListener("click", () => {
        if (audio.paused) {
          audio.play();
          playBtn.innerHTML = "⏸";
          playBtn.classList.add('playing');
        } else {
          audio.pause();
          playBtn.innerHTML = "▶";
          playBtn.classList.remove('playing');
        }
      });

      // Next song
      nextBtn.addEventListener("click", () => {
        if (isShuffled) {
          currentIndex = Math.floor(Math.random() * songs.length);
        } else {
          currentIndex = (currentIndex + 1) % songs.length;
        }
        loadSong(currentIndex);
      });

      // Previous song
      prevBtn.addEventListener("click", () => {
        if (isShuffled) {
          currentIndex = Math.floor(Math.random() * songs.length);
        } else {
          currentIndex = (currentIndex - 1 + songs.length) % songs.length;
        }
        loadSong(currentIndex);
      });

      // Progress bar update
      audio.addEventListener("timeupdate", () => {
        progress.value = (audio.currentTime / audio.duration) * 100 || 0;
        currentTime.textContent = formatTime(audio.currentTime);
      });

      // Seek song
      progress.addEventListener("input", () => {
        audio.currentTime = (progress.value / 100) * audio.duration;
      });

      // Volume control
      volume.addEventListener("input", () => {
        audio.volume = volume.value;
      });

      // Like button functionality
      likeBtn.addEventListener("click", () => {
        const currentSong = songs[currentIndex];
        if (currentSong) {
          if (likedSongs.has(currentSong.title)) {
            likedSongs.delete(currentSong.title);
            likeBtn.style.color = '#9CA3AF';
          } else {
            likedSongs.add(currentSong.title);
            likeBtn.style.color = '#1DB954';
          }
        }
      });

      // Shuffle button
      shuffleBtn.addEventListener("click", () => {
        isShuffled = !isShuffled;
        shuffleBtn.style.color = isShuffled ? '#1DB954' : '#9CA3AF';
      });

      // Repeat button
      repeatBtn.addEventListener("click", () => {
        isRepeated = !isRepeated;
        audio.loop = isRepeated;
        repeatBtn.style.color = isRepeated ? '#1DB954' : '#9CA3AF';
      });

      // Auto play next song when current ends
      audio.addEventListener("ended", () => {
        if (isRepeated) {
          audio.currentTime = 0;
          audio.play();
        } else {
          nextBtn.click();
        }
      });

      // Search filter - search both title and artist
      search.addEventListener("input", () => {
        const query = search.value.toLowerCase();
        Array.from(songsGrid.children).forEach((card) => {
          const title = card.dataset.title.toLowerCase();
          const artist = card.dataset.artist.toLowerCase();
          card.style.display = (title.includes(query) || artist.includes(query)) ? "block" : "none";
        });
      });

      // Load songs from user folder
      fileInput.addEventListener("change", (e) => {
        songs = [];
        songsGrid.innerHTML = "";
        const files = Array.from(e.target.files).filter((f) => f.type.startsWith("audio"));

        files.forEach((file, idx) => {
          let song = {
            file,
            title: file.name.replace(/\.[^/.]+$/, ""), // Remove file extension
            artist: "",
            cover: ""
          };

          // Extract artist name from filename first
          song.artist = extractArtistName(file.name);

          new jsmediatags.Reader(file).read({
            onSuccess: (tag) => {
              // Use metadata if available, otherwise keep the extracted name
              if (tag.tags.title) song.title = tag.tags.title;
              if (tag.tags.artist && tag.tags.artist.trim() !== "") {
                song.artist = tag.tags.artist; // Use metadata artist if available
              }

              if (tag.tags.picture) {
                let data = tag.tags.picture.data;
                let format = tag.tags.picture.format;
                let base64 = "";

                for (let i = 0; i < data.length; i++) {
                  base64 += String.fromCharCode(data[i]);
                }

                song.cover = `data:${format};base64,${window.btoa(base64)}`;
              }
              renderSong(song, idx);
            },
            onError: () => {
              // If error reading metadata, use the extracted artist name
              renderSong(song, idx);
            }
          });

          songs.push(song);
        });

        // Show notification
        if (files.length > 0) {
          showNotification(`Successfully loaded ${files.length} songs`);
        }
      });

      // Fallback images
      const fallbackImages = [
        "image/Trending/3.jpg",
        "image/Trending/2.jpg",
        "image/Trending/4.jpg",
        "image/Trending/5.jpg",
        "image/Trending/6.jpg",
      ];

      // Render song
      function renderSong(song, idx) {
        const card = document.createElement("div");
        card.className = "bg-zinc-900 hover:bg-zinc-800 p-3 rounded-lg cursor-pointer transition-all group hover-lift";
        card.dataset.title = song.title;
        card.dataset.artist = song.artist;

        // Pick cover image if exists
        const coverSrc = song.cover && song.cover.trim() !== "" 
          ? song.cover 
          : fallbackImages[idx % fallbackImages.length];

        card.innerHTML = `
          <div class="relative mb-3">
            <img src="${coverSrc}" class="w-full h-32 object-cover rounded" />
            <button class="absolute bottom-2 right-2 w-10 h-10 bg-green-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all hover:scale-105">
              <svg class="w-5 h-5 text-black" fill="currentColor" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
          </div>
          <p class="font-bold truncate">${song.title}</p>
          <p class="text-xs text-gray-400 truncate">${song.artist}</p>
        `;

        card.addEventListener("click", () => {
          currentIndex = idx;
          loadSong(currentIndex);
        });

        songsGrid.appendChild(card);
      }

      // Show notification
      function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all';
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.opacity = '0';
          setTimeout(() => {
            notification.remove();
          }, 300);
        }, 3000);
      }

      // Initialize with default state
      window.addEventListener('load', () => {
        if (songs.length === 0) {
          currentTitle.textContent = "No song selected";
          currentArtist.textContent = "Upload some music to get started";
        }
      });
    </script>
  </body>
</html>